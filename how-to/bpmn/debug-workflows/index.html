<!doctype html><html lang=en class="js csstransforms3d"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-0PJKXDWQ4P"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0PJKXDWQ4P")}</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=referrer content="no-referrer-when-downgrade"><meta property="og:image" content="https://docs.rhize.com/images/rhize-logo.png"><meta property="og:image:secure_url" content="https://docs.rhize.com/images/rhize-logo.png"><meta property="og:description" content="Strategies to handle errors in your BPMN workflows, and ways to debug workflows when things don't work as expected."><meta property="og:type" content="website"><meta property="og:title" content="Handle errors and debug"><meta property="og:site_name" content="Rhize documentation"><meta property="og:url" content="https://docs.rhize.com/how-to/bpmn/debug-workflows/"><meta property="og:locale" content="en"><meta name=generator content="Hugo 0.134.3"><meta name=description content="Strategies to handle errors in your BPMN workflows, and ways to debug workflows when things don't work as expected."><link rel=canonical href=https://docs.rhize.com/how-to/bpmn/debug-workflows/><link rel=apple-touch-icon sizes=57x57 href=https://docs.rhize.com/images/favicons/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=https://docs.rhize.com/images/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=https://docs.rhize.com/images/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=https://docs.rhize.com/images/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=https://docs.rhize.com/images/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=https://docs.rhize.com/images/favicons/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=https://docs.rhize.com/images/favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=https://docs.rhize.com/images/favicons/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=https://docs.rhize.com/images/favicons/apple-touch-icon-180x180.png><link rel=icon type=image/png href=https://docs.rhize.com/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://docs.rhize.com/images/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=https://docs.rhize.com/images/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://docs.rhize.com/images/favicons/favicon-16x16.png sizes=16x16><link rel=manifest href=https://docs.rhize.com/images/favicons/manifest.webmanifest><link rel=mask-icon href=https://docs.rhize.com/images/favicons/safari-pinned-tab.svg color=#fe2c06><link rel="shortcut icon" href=https://docs.rhize.com/images/favicons/favicon.ico><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js></script><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/go.min.js></script><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/java.min.js integrity="sha256-RyOs5MjQ+Ef9DQrPHp4QGr2tcNjxLh6mCkkW+sS4doU=" crossorigin=anonymous></script><script src=//code.jquery.com/jquery-3.2.1.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><title>Handle errors and debug | How to
</title><link href=https://docs.rhize.com/css/theme.css?55e52aec195a82e2ea2d860ffc75cf75 rel=stylesheet><link href=https://docs.rhize.com/css/runnable.css?46648956d99faa2e057d109b9f2a52e6 rel=stylesheet><link href=https://docs.rhize.com/css/tabs.css?035edc32762cb7973b740e3067101ced rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css rel=stylesheet integrity=sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ crossorigin=anonymous><script src=//cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js integrity=sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb crossorigin=anonymous></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js integrity=sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn crossorigin=anonymous></script><link href="//fonts.googleapis.com/css?family=Lato:400,700" rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link href=https://cdn.lineicons.com/2.0/LineIcons.css rel=stylesheet crossorigin=anonymous><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/9290851.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3></head><body><nav id=header><div class=header-left><div><a href=https://docs.rhize.com/ class=brand><img src=https://docs.rhize.com//images/rhize-logo.png alt=RHIZE class=logo></a><div class=logo-tagline><span>Documentation</span></div></div></div><div class=header-right><div id=docsearch><div class="menu-search align-middle"><div id=docsearch></div></div></div><div><ul class=menu><li><a href=https://rhize.com target=_blank>Home</a></li><li><a href=https://forum.rhize.com target=_blank>Community</a></li><li><a href=https://www.youtube.com/@rhizemanufacturingdatahub target=_blank>Youtube</a></li></ul></div></div><a href=# id=sidebar-toggle><i class="fa fa-bars"></i></a></nav><aside id=sidebar><ul class=topics><li class="topic main-topic children"><a id=get-started href=#>Get started</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/get-started/introduction/>What is Rhize?</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/get-started/how-rhize-works/>How Rhize works</a></li></ul></li><li class="topic main-topic children"><a id=deploy href=#>Deploy</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Install</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/install/overview/>Overview</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/install/setup-kubernetes/>Set up Kubernetes</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/install/keycloak/>Configure Keycloak</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/install/services/>Install Rhize services</a></li></ul></li><li class="topic sub-topic"><a href=#>Back up</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/backup/graphdb/>Back up the Graph DB</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/backup/audit/>Back up Audit PostgreSQL</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/backup/grafana/>Back up Grafana</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/backup/keycloak/>Back up Keycloak</a></li></ul></li><li class="topic sub-topic"><a href=#>Restore</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/restore/graphdb/>Restore the GraphDB</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/restore/audit/>Restore Audit backup</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/restore/grafana/>Restore Grafana</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/restore/keycloak/>Restore Keycloak</a></li></ul></li><li class="topic sub-topic"><a href=#>Maintain</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/maintain/audit/>Archive the PostgreSQL Audit trail</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/maintain/bpmn-nodes/>BPMN execution recovery</a></li></ul></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/upgrade/>Upgrade</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/about-openidconnect/>About OpenID connect</a></li></ul></li><li class="topic main-topic children active"><a id=user-guides href=#>User guides</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Use GraphQL</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/call-the-graphql-api/>Overview: the Rhize API</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/query/>Query</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/filter/>Filter</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/mutate/>Mutate</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/subscribe/>Subscribe</a></li></ul></li><li class="topic sub-topic active"><a href=#>Write BPMN workflows</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/create-workflow/>Overview: orchestrate processes</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/trigger-workflows/>Trigger workflows</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/use-jsonata/>Use JSONata</a></li><li class="topic sub-topic active"><a href=https://docs.rhize.com/how-to/bpmn/debug-workflows/>Handle errors and debug</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/tune-performance/>Tune performance</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/variables/>Special variables</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/naming-conventions/>Naming conventions</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/learning-resources/>BPMN learning resources</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/bpmn-elements/>BMPN elements</a></li></ul></li><li class="topic sub-topic"><a href=#>Define production models</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/model/create-objects-ui/>Create objects from the UI</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/model/master-definitions/>Master definitions and fields</a></li></ul></li><li class="topic sub-topic"><a href=#>Connect event data</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/publish-subscribe/connect-datasource/>Connect data source</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/publish-subscribe/create-equipment-class-rule/>Tutorial: Trigger a workflow from a rule</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/publish-subscribe/track-changes/>Track changes (CDC)</a></li></ul></li><li class="topic sub-topic"><a href=#>Use work calendars</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/work-calendars/about-calendars-and-overrides/>About calendars and overrides</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/work-calendars/create-work-calendar/>Create work calendars</a></li></ul></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/audit/>Audit</a></li></ul></li><li class="topic main-topic children"><a id=use-cases href=#>Use cases</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/use-cases/overview/>Overview</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/use-cases/genealogy/>Genealogy</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/use-cases/ebr/>Electronic batch records</a></li></ul></li><li class="topic main-topic children"><a id=reference href=#>Reference</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Service configuration</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/agent-configuration/>Agent configuration</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/audit-configuration/>Audit configuration</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/bpmn-configuration/>BPMN configuration</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/calendar-configuration/>Calendar configuration</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/core-configuration/>Core configuration</a></li></ul></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/observability-metrics/>Observability metrics</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/default-ports/>Default URLs and local ports</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/gql-types/>GQL types and filters</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/glossary/>Glossary</a></li></ul></li><li class="topic main-topic children"><a id=explanations href=#>Explanations</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/explanations/manufacturing-data-hub/>Manufacturing Data Hub</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/explanations/isa-95-diagrams/>ISA-95 diagrams</a></li></ul></li><li class="topic main-topic children"><a id=releases href=#>Releases</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/3-0-1/>3.0.1</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/3-0/>3.0.0</a></li><li class="topic sub-topic"><a href=#>Changelog</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0/>3.0.0 (general release)</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc09/>3.0.0rc09</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc08/>3.0.0rc08</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc07/>3.0.0rc07</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc06/>3.0.0rc06</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc05/>3.0.0rc05</a></li></ul></li></ul></li><li class="topic main-topic"><a href=https://docs.rhize.com/></a></li></ul></aside><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script><script type=text/javascript>docsearch({appId:"70JLDGIDQA",apiKey:"2b4c57aa9d3d0386bf1a6df5b54eb3cf",indexName:"rhize",insights:!0,container:"#docsearch",debug:!1})</script></body></html><main class=content-wrapper><div class=content><div class=top-toc><nav id=TableOfContents><ul><li><a href=#strategies-to-handle-errors>Strategies to handle errors</a><ul><li><a href=#gateways>Gateways</a></li><li><a href=#json-schema-validation>JSON schema validation</a></li><li><a href=#jsonata-conditions>JSONata conditions</a></li><li><a href=#check-jsonata-output>Check JSONata output</a></li><li><a href=#create-event-logging>Create event logging</a></li></ul></li><li><a href=#strategies-to-debug>Strategies to debug</a><ul><li><a href=#debug-from-the-api-calls>Debug from the API calls</a></li><li><a href=#debug-in-tempo>Debug in Tempo</a></li><li><a href=#adding-the-debug-flag>Adding the debug flag</a></li></ul></li></ul></nav></div><article><a class=edit-btn target=_blank href=https://github.com/libremfg/libremfg.github.io/edit/main/content/how-to/bpmn/debug-workflows.md><i class="fa fa-github-alt"></i> Edit Page</a><h1 class=post-title>Handle errors and debug</h1><p>Errors come in two categories: expected and unexpected.
The Rhize BPMN engine has ways to handle both.</p><p>A robust workflow should have built-in logic to anticipate errors.
For unexpected issues, Rhize also creates a <em>trace</em> for each workflow,
which you can use to observe the behavior and performance of the workflow at each element as it executes sequentially.
You can also use debug flags and variables to trace variable context as it transforms across the workflow.</p><h2 id=strategies-to-handle-errors>Strategies to handle errors</h2><p>All error handling likely uses some conditional logic.
The workflow author anticipates the error and then writes some logic to conditionally handle it.
However, you have many ways to handle conditions. When deciding how to direct flows, consider both the context of the error and overall readability of your diagram.
This section describes some key strategies.</p><h3 id=gateways>Gateways</h3><p>Use <a href=https://docs.rhize.com/how-to/bpmn/bpmn-elements/#gateways>exclusive gateways</a> for any type of error handling.
For example, you might define a normal range for a value, then send alerts for when the value falls outside of this range.
If it makes sense, these error branches also might flow into an early end event.</p><figure class=big-figure><a href=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-error-handling-custom-response.png target=_blank><img src=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-error-handling-custom-response.png alt="A BPMN workflow with customResponse in the output of the end node" width=80%></a><figcaption class=caption>Download this workflow from <a href=https://github.com/libremfg/rhize-templates/tree/main/bpmn/custom-response-error-events>BPMN templates</a></figcaption></figure><h3 id=json-schema-validation>JSON schema validation</h3><p>Validation can greatly limit the scope of possible errors.
To validate your JSON payloads, use the <a href=https://docs.rhize.com/how-to/bpmn/bpmn-elements/#json-schema>JSON schema task</a>.</p><p>The JSON schema task outputs a boolean value that indicates whether the input conforms to the schema that you set.
You can then set a condition based on whether this <code>valid</code> variable is true, and create logic to handle errors accordingly.
For example, this schema requires that the input variables include a property <code>arr</code> whose
value is an array of numbers.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  &#34;$schema&#34;: <span style=color:#a31515>&#34;http://json-schema.org/draft-07/schema#&#34;</span>,
</span></span><span style=display:flex><span>  &#34;title&#34;: <span style=color:#a31515>&#34;Generated schema for Root&#34;</span>,
</span></span><span style=display:flex><span>  &#34;type&#34;: <span style=color:#a31515>&#34;object&#34;</span>,
</span></span><span style=display:flex><span>  &#34;properties&#34;: { &#34;arr&#34;: { &#34;type&#34;: <span style=color:#a31515>&#34;array&#34;</span>, &#34;items&#34;: { &#34;type&#34;: <span style=color:#a31515>&#34;number&#34;</span> } } },
</span></span><span style=display:flex><span>  &#34;required&#34;: [<span style=color:#a31515>&#34;arr&#34;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In a production workflow, you might use this exact schema to validate the input for a function that calculates statistics (perhaps choosing a different variable name).</p><figure class=big-figure><a href=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-json-schema.png target=_blank><img src=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-json-schema.png alt="Screenshot of a conditional that branches when the JSON schema task receives invalid input." width=35%></a><figcaption class=caption>A conditional that branches when the JSON schema task receives invalid input. <a href=https://github.com/libremfg/rhize-templates/tree/main/bpmn/call-activity-calculate-stats>Download the template</a></figcaption></figure><h3 id=jsonata-conditions>JSONata conditions</h3><p>Besides the logical gateway, it may make sense to use JSONata ternary expressions in one of the many parameters that accepts JSONata expressions.
For example, this expression creates one message body if <code>valid</code> is <code>true</code> and another if not:</p><pre tabindex=0><code class=language-jsonata data-lang=jsonata>=
{
  &#34;message&#34;: $.valid ? &#34;payload is valid&#34; : &#34;Invalid payload&#34; 
}
</code></pre><h3 id=check-jsonata-output>Check JSONata output</h3><p>If a field has no value, JSONata outputs nothing.
For example, the following expression outputs only <code>{"name": "Rhize"}</code>,
because no <code>$err</code> field exists.</p><div class=tabs><ul class="nav nav-tabs"></ul><div class=tab-content><div class=tab-pane title=EXPRESSION><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span>=(</span> 
</span></span><span style=display:flex><span>  <span>$name</span> <span>:=</span> <span style=color:#a31515>&#34;Rhize&#34;</span><span>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  { 
</span></span><span style=display:flex><span>  &#34;name&#34;: <span>$name</span>,
</span></span><span style=display:flex><span>  &#34;error&#34;: <span>$err</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span>)</span>
</span></span></code></pre></div></div><div class=tab-pane title=OUTPUT><pre tabindex=0><code>{
  &#34;name&#34;: &#34;Rhize&#34;
}
</code></pre></div></div></div><p>You can use this behavior to direct flows.
For example, an exclusive gateway may have a condition such as <code>$exists(err)</code> that flows into an error-handling condition.</p><h3 id=create-event-logging>Create event logging</h3><p>To persist error handling, you can set gateways that flow to mutation tasks that use the <code>addEvent</code> operation.
The added event may be a successful operation, an error, or both,
creating a record of events emitted in the workflow that are stored in your manufacturing knowledge graph.
This strategy increases the observability of errors and facilitates future analysis.
It may also be useful when combined with the debugging strategies described in the next section.</p><h2 id=strategies-to-debug>Strategies to debug</h2><p>For detailed debugging,
you can use an embedded instance of <a href=https://github.com/grafana/tempo>Grafana Tempo</a> to inspect each step of the workflow, node by node.
To debug on the fly, you may also find it useful to use <code>customResponse</code> and intermediate message throws to print variables and output at different checkpoints.</p><h3 id=debug-from-the-api-calls>Debug from the API calls</h3><p>When you first test or run a workflow, consider starting the testing and debugging process from an API trigger.
All API triggers return information about the workflow state (for example <code>COMPLETED</code> or <code>ABORTED</code>).
With the <code>createAndRunBpmnSync</code> operation, you can also use the <code>customResponse</code> to provide information from the workflow&rsquo;s variable context.
For details of how this works, read the guide to <a href=https://docs.rhize.com/how-to/bpmn/trigger-workflows/>triggering workflows</a>.</p><p>For example, consider a workflow that has two nodes, a Message throw event and a REST task.</p><ol><li>When the message completes, the user writes <code>Message sent</code> into <code>customResponse</code> as an output variable.</li><li>When the REST task completes, the response is saved into <code>customResponse</code>.</li></ol><p>So the <code>jobState</code> property reports on the overall workflow status, and <code>customResponse</code> serves as a checkpoint to report the state of each node execution.
You can also request the <code>dataJSON</code> field, which reports the entire variable context at the last node.
Now imagine that the user has started the workflow from the API and receives this response:</p><pre tabindex=0><code>{
  &#34;data&#34;: {
    &#34;createAndRunBpmnSync&#34;: {
      &#34;jobState&#34;: &#34;ABORTED&#34;,
      &#34;customResponse&#34;: &#34;message sent&#34;,
      &#34;traceID&#34;: &#34;993ee32af9522f5b35b4ec80f4ff58a8&#34;
    }
  }
}
</code></pre><p>Note how <code>ABORTED</code> indicates the workflow failed somewhere.
Yet, the value of <code>customResponse</code> must have been set after the message event executed.
So the problem is likely with the REST node.</p><p>You could also use a similar strategy with intermediate message events.
However, while <code>customResponse</code> and messages are undoubtedly useful debugging methods, they are also limited— the BPMN equivalents of <code>printf()</code> debugging.
For full-featured debugging, use the <code>traceID</code> to explore the workflow through Tempo.</p><h3 id=debug-in-tempo>Debug in Tempo</h3><div class="notices note"><span class=type>Note</span> The instructions here provide the minimum about using Tempo as a tool.
To discover the many ways you can filter your BPMN traces for debugging and analysis,
refer to the <a href=https://grafana.com/docs/tempo/latest/>official documentation</a>.</div><p>Rhize creates a unique ID and trace for each workflow that runs.
This ID is reported as the <code>traceID</code> in the <code>createAndRunBPMN</code> mutation operation.
Within this trace, each node is <em>instrumented</em>, with spans emitted at every input and output along each node of execution.
With the trace ID, you can find the workflow run in Tempo and follow the behavior.</p><p>To inspect a workflow in Tempo:</p><ol><li>Go to your Grafana instance.</li><li>Select <strong>Explore</strong> and then Tempo.</li><li>From the <strong>TraceQL</strong> tab, enter the <code>traceID</code> and query.
Alternatively, use the <strong>Search</strong> tab with the <code>bpmn-engine</code> to find traces for all workflows.</li></ol><figure class=big-figure><a href=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-spans-in-tempo-compact.png target=_blank><img src=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-spans-in-tempo-compact.png alt="Screenshot of a compact view of spans for a BPMN process in Tempo" width=55%></a><figcaption class=caption>Screenshot of a compact view of spans for a BPMN process in Tempo</figcaption></figure><p>Each workflow instance displays <em>spans</em> that trace the state of each node at its start, execution, and end states.
When debugging, you are likely interested in the spans that result in <code>ABORTED</code>.
To inspect the errors:</p><ol><li>Select the nodes with errors.</li><li>Use the <code>events</code> property to inspect for exceptions.</li></ol><p>For example, this REST task failed because the URL was invalid.</p><figure class=big-figure><a href=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-tempo-error-node.png target=_blank><img src=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-tempo-error-node.png alt="Screenshot of a detailed view of an error for a BPMN process in Tempo" width=55%></a><figcaption class=caption>A detailed view of an error for a BPMN process in Tempo</figcaption></figure><p>Also note the names of the spans in the previous two screenshots.
Names that convey semantic information it easier to find specific nodes and easier to understand and follow the overall workflow.
Well-named nodes make debugging easier.
This is one of the reasons we recommend always following a set of <a href=https://docs.rhize.com/how-to/bpmn/naming-conventions/>naming conventions</a> when you author BPMN workflows.</p><h3 id=adding-the-debug-flag>Adding the debug flag</h3><p>For granular debugging, it also helps to trace the variable context as it passes from node to node.
To facilitate this, Rhize provides a debugging option that you can pass in multiple ways:</p><ul><li>From an API call with the <code>debug:true</code> <a href=https://docs.rhize.com/how-to/gql/call-the-graphql-api/#request-body>argument</a>.</li><li>In the process variable context, by setting <code>__traceDebug: true</code></li><li>In the <a href=https://docs.rhize.com/reference/service-config/bpmn-configuration/>BPMN service configuration</a> by setting <code>OpenTelemetry.defaultDebug</code> to <code>true</code></li></ul><p>When the debugging variable is set, Tempo reports the entire variable context in the <strong>Span Attributes</strong> at the end of each node.</p><figure class=big-figure><a href=https://docs.rhize.com/images/bpmn/screenshot-rhize-variable-spans.png target=_blank><img src=https://docs.rhize.com/images/bpmn/screenshot-rhize-variable-spans.png alt="Screenshot showing the process variable context at the end of a node in a BPMN workflow." width=55%></a><figcaption class=caption>The process variable context at the end of a node in a BPMN workflow.</figcaption></figure></article><div class=right-toc><nav id=TableOfContents><ul><li><a href=#strategies-to-handle-errors>Strategies to handle errors</a><ul><li><a href=#gateways>Gateways</a></li><li><a href=#json-schema-validation>JSON schema validation</a></li><li><a href=#jsonata-conditions>JSONata conditions</a></li><li><a href=#check-jsonata-output>Check JSONata output</a></li><li><a href=#create-event-logging>Create event logging</a></li></ul></li><li><a href=#strategies-to-debug>Strategies to debug</a><ul><li><a href=#debug-from-the-api-calls>Debug from the API calls</a></li><li><a href=#debug-in-tempo>Debug in Tempo</a></li><li><a href=#adding-the-debug-flag>Adding the debug flag</a></li></ul></li></ul></nav></div></div></main><script type=text/javascript src=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js></script><script src=https://docs.rhize.com/js/clipboard.min.js></script><script src=https://docs.rhize.com/js/dgraph.js?a9873668f1334ff6c49d4edea0a4bc38></script><script>hljs.initHighlightingOnLoad()</script></body></html>