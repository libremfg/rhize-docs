<!doctype html><html lang=en class="js csstransforms3d"><head><script></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=referrer content="no-referrer-when-downgrade"><meta property="og:image" content="https://libremfg.github.io/images/rhize-logo.png"><meta property="og:type" content="website"><meta property="og:title" content><meta property="og:site_name" content><meta property="og:url" content="https://libremfg.github.io/how-to/gql/call-the-graphql-api/"><meta property="og:locale" content="en"><meta name=generator content="Hugo 0.120.4"><meta name=description content="How to query your manufacturing knowledge graph"><link rel=canonical href=https://libremfg.github.io/how-to/gql/call-the-graphql-api/><link rel=apple-touch-icon sizes=57x57 href=https://libremfg.github.io/images/favicons/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=https://libremfg.github.io/images/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=https://libremfg.github.io/images/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=https://libremfg.github.io/images/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=https://libremfg.github.io/images/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=https://libremfg.github.io/images/favicons/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=https://libremfg.github.io/images/favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=https://libremfg.github.io/images/favicons/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=https://libremfg.github.io/images/favicons/apple-touch-icon-180x180.png><link rel=icon type=image/png href=https://libremfg.github.io/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://libremfg.github.io/images/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=https://libremfg.github.io/images/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://libremfg.github.io/images/favicons/favicon-16x16.png sizes=16x16><link rel=manifest href=https://libremfg.github.io/images/favicons/manifest.json><link rel=mask-icon href=https://libremfg.github.io/images/favicons/safari-pinned-tab.svg color=#fe2c06><link rel="shortcut icon" href=https://libremfg.github.io/images/favicons/favicon.ico><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js></script><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/go.min.js></script><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/java.min.js integrity="sha256-RyOs5MjQ+Ef9DQrPHp4QGr2tcNjxLh6mCkkW+sS4doU=" crossorigin=anonymous></script><script src=//code.jquery.com/jquery-3.2.1.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.js integrity="sha256-x3BtPVERvw1ozPlwivuFLZoViFCeAAs1Gt6SxEedmo8=" crossorigin=anonymous></script><link href=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.css rel=stylesheet integrity="sha256-7sZe9dsqyNZC9Mk+WPRB7nVvPPPXyorzm2QKqlgXC4k=" crossorigin=anonymous><script async src=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/addon/edit/closebrackets.min.js integrity="sha256-qhu2a7DSpQaammMaLw1iruxBpxmgdw8mdQaQWQUokcY=" crossorigin=anonymous></script><script async src=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/mode/javascript/javascript.min.js integrity="sha256-7Bdg/UdDMmHDPafpQDYZNPCEbnRP7eAvu+2hEoqRCXs=" crossorigin=anonymous></script><title>Call the GraphQL API
|
How to
</title><link href=https://libremfg.github.io/css/theme.css?af91ed3e658dfbbd6b27fecd1ddc8632 rel=stylesheet><link href=https://libremfg.github.io/css/runnable.css?46648956d99faa2e057d109b9f2a52e6 rel=stylesheet><link href=https://libremfg.github.io/css/tabs.css?035edc32762cb7973b740e3067101ced rel=stylesheet><link href=//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css rel=stylesheet integrity=sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ crossorigin=anonymous><script src=//cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js integrity=sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb crossorigin=anonymous></script><script src=//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js integrity=sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn crossorigin=anonymous></script><link href="//fonts.googleapis.com/css?family=Lato:400,700" rel=stylesheet><link href=//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link href=https://cdn.lineicons.com/2.0/LineIcons.css rel=stylesheet crossorigin=anonymous><link rel=stylesheet href=//cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css></head><body><nav id=header><div class=header-left><div><a href=https://libremfg.github.io/ class=brand><img src=https://libremfg.github.io/images/rhize-logo.png alt=RHIZE class=logo></a><div class=logo-tagline><span>DRAFT Documentation</span></div></div></div><div class=header-right><div style=margin-top:10px><div class="menu-search align-middle"><div class=menu-search-inner><input type=search class="form-control form-control-sm" placeholder="Search documentation" aria-label="Search docs" autocomplete=off></div></div></div><div><ul class=menu><li><a href=https://rhize.com target=_blank>Home</a></li><li><a href=https://discord.gg/ZRpUBXmrkV target=_blank>Community</a></li><li><a href=https://github.com/libremfg/libremfg.github.io target=_blank>GitHub</a></li></ul></div></div><a href=# id=sidebar-toggle><i class="fa fa-bars"></i></a></nav><aside id=sidebar><ul class=topics><li class="topic main-topic children"><a id=get-started href=#>Get started</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://libremfg.github.io/get-started/introduction/>What is Rhize?</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/get-started/how-rhize-works/>How Rhize works</a></li></ul></li><li class="topic main-topic children"><a id=deploy href=#>Deploy</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Install</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/install/overview/>Overview</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/install/setup-kubernetes/>Set up Kubernetes</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/install/keycloak/>Configure Keycloak</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/install/services/>Install Rhize services</a></li></ul></li><li class="topic sub-topic"><a href=#>Back up</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/backup/graphdb/>Back up the Graph DB</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/backup/grafana/>Back up Grafana</a></li></ul></li><li class="topic sub-topic"><a href=#>Restore</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/restore/graphdb/>Restore the GraphDB</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/restore/grafana/>Restore Grafana</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/restore/bpmn-nodes/>BPMN execution recovery</a></li></ul></li><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/upgrade/>Upgrade</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/deploy/about-openidconnect/>About OpenID connect</a></li></ul></li><li class="topic main-topic children active"><a id=user-guides href=#>User guides</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Define production models</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://libremfg.github.io/how-to/model/create-objects-ui/>Create objects from the UI</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/how-to/model/master-definitions/>Master definitions and fields</a></li></ul></li><li class="topic sub-topic"><a href=#>Connect process events</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://libremfg.github.io/how-to/publish-subscribe/track-changes/>Track changes (CDC)</a></li></ul></li><li class="topic sub-topic"><a href=#>Handle events</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://libremfg.github.io/how-to/bpmn/create-workflow/>Create BPMN workflows</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/how-to/bpmn/bpmn-elements/>BMPN elements</a></li></ul></li><li class="topic sub-topic active"><a href=#>Use the knowledge graph</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic active"><a href=https://libremfg.github.io/how-to/gql/call-the-graphql-api/>Call the GraphQL API</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/how-to/gql/query-mutate-subscribe/>Query, mutate, and subscribe</a></li></ul></li></ul></li><li class="topic main-topic children"><a id=reference href=#>Reference</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://libremfg.github.io/reference/agent-configuration/>Agent configuration</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/reference/nats-config/>NATS configuration</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/reference/default-ports/>Default local ports</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/reference/glossary/>Glossary</a></li></ul></li><li class="topic main-topic children"><a id=releases href=#>Releases</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://libremfg.github.io/releases/3-0-0rc07/>3.0.0rc07</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/releases/3-0-0rc06/>3.0.0rc06</a></li><li class="topic sub-topic"><a href=https://libremfg.github.io/releases/3-0-0rc05/>3.0.0rc05</a></li></ul></li><li class="topic main-topic"><a href=https://libremfg.github.io/></a></li></ul></aside></body></html><main class=content-wrapper><div class=content><div class=top-toc><nav id=TableOfContents><ul><li><a href=#operation-types>Operation types</a></li><li><a href=#call-syntax>Call syntax</a><ul><li><a href=#authentication>Authentication</a></li><li><a href=#request-body>Request body</a></li><li><a href=#request-exactly-the-data-you-want>Request exactly the data you want</a></li><li><a href=#variables>Make input dynamic with variables</a></li></ul></li><li><a href=#shortcuts-for-more-expressive-requests>Shortcuts for more expressive requests</a><ul><li><a href=#template-requested-fields-with-fragments>Template requested fields with fragments</a></li><li><a href=#filter>Filter arrays</a></li><li><a href=#cascade>Cascade</a></li></ul></li></ul></nav></div><article><a class=question-btn target=_blank href=https://discord.gg/ZRpUBXmrkV><i class="fa fa-question-circle"></i> Ask a Question</a><h1 class=post-title>Call the GraphQL API</h1><p>In a manufacturing operation, all event data is interrelated.
To make these relations explorable, Rhize stores data in a special-purpose graph database designed to represent all levels of the manufacturing process.
This database is enforced by our ISA-95 schema, the most comprehensive data representation of ISA-95 in the world.</p><p>Rhize exposes this database through a <a href=https://graphql.org/>GraphQL API</a>.
Unlike REST, GraphQL requires only one endpoint, and you can define exactly the data that you return for each operation.</p><p>If you are a customer, the best way to learn both GraphQL and ISA-95 modelling is to use the <a href=https://www.apollographql.com/>Apollo Explorer</a> for our schema.
However, for newcomers to GraphQL, the flexibility may look overwhelming.
These topics introduce the basics of how to use GraphQL with Rhize&rsquo;s custom database.</p><p>Once you learn how to explore the API, you&rsquo;ll find that the interface is more comfortable and discoverable than a comparable OpenAPI (Swagger) documentâ€”and that&rsquo;s before considering the improvements GraphQL brings to precision, performance, and developer experience.</p><h2 id=operation-types>Operation types</h2><p>In GraphQL, an <em>operation</em> is a request to the server.
Rhize supports three types of operations:</p><ul><li><strong>Queries</strong> return data and subsets of data.</li><li><strong>Mutations</strong> change the data on the server side.</li><li><strong>Subscriptions</strong> notify about data changes in real time.</li></ul><p>For details and examples, refer to <a href=https://libremfg.github.io/how-to/gql/query-mutate-subscribe/>Query, Mutate, Subscribe</a>.</p><h2 id=call-syntax>Call syntax</h2><p>The following sections show you the essential features to make a query.</p><h3 id=authentication>Authentication</h3><p>To authenticate your requests, pass a bearer token as an <code>Authorization</code> header.
Be sure to preface the value with the word <code>Bearer </code>:</p><figure><img src=https://libremfg.github.io/images/screenshot-rhize-apollo-auth-headers.png alt="Example of how it looks in Apollo explorer" width=50%></figure><p>For an overview of how Rhize handles token exchange, read <a href=https://libremfg.github.io/deploy/about-openidconnect/>About OpenID connect</a>.</p><h3 id=request-body>Request body</h3><p>By default, all GraphQL operations have the following structure:</p><ol><li><p>Define the operation type (one of, <code>query</code>, <code>mutation</code>, or <code>subscription</code>).</p></li><li><p>Name the query anything you want. This example builds a <code>query</code> called <code>myCustomName</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>myCustomName</span> {
</span></span><span style=display:flex><span>    <span style=color:green>#operations will go here</span>
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div></li><li><p>In curly brackets, define the <em>operation</em> you want to query.</p></li><li><p>In parenthesis next to the operation, add the <em>arguments</em> to pass. This example uses the <code>getEquipment</code> operation, and its arguments specify which item of equipment to get.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>myCustomName</span> {
</span></span><span style=display:flex><span>  getEquipment(id: <span style=color:#a31515>&#34;Kitchen_mixer_b_01&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:green>#Fields go here</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div></li><li><p>Within the operation, define the fields you want to return. This example queries for the equipment ID and the person who created the entity.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>myCustomName</span> {
</span></span><span style=display:flex><span>  getEquipment(id: <span style=color:#a31515>&#34;Kitchen_mixer_b_01&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>id</span>
</span></span><span style=display:flex><span>    _createdBy
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>As you might expect, the request returns only these fields for the equipment named <code>Kitchen_mixer_b_01</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>   &#34;data&#34;: {
</span></span><span style=display:flex><span>     &#34;getEquipment&#34;: {
</span></span><span style=display:flex><span>       &#34;id&#34;: <span style=color:#a31515>&#34;Kitchen_mixer_b_01&#34;</span>,
</span></span><span style=display:flex><span>       &#34;_createdBy&#34;: <span style=color:#a31515>&#34;john_snow&#34;</span>
</span></span><span style=display:flex><span>     }
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span> }
</span></span></code></pre></div></li></ol><h3 id=request-exactly-the-data-you-want>Request exactly the data you want</h3><p>A major benefit of GraphQL is that you can modify queries to return only the fields you want.
You can join data entities in a single query and query for entity relationships in the same way that you would for entity attributes.</p><p>Unlike calls to REST APIs, where the server-side code defines what a response looks like, GraphQL calls instruct the server to return only what is specified.
Furthermore, you can query diverse sets of data in one call, so you can get exactly the entities you want without calling multiple endpoints, as you would in REST, or composing queries with complex recursive joins, as you would in SQL.
Besides precision, this also brings performance benefits to minimize network calls and their payloads.</p><p>For example, you modify the previous request to return information about the equipments versions, including their <code>description</code>, unique IDs, and the currently active version:</p><div class=tabs><ul class="nav nav-tabs"></ul><div class=tab-content><div class=tab-pane title=REQUEST><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>ExampleQuery</span> {
</span></span><span style=display:flex><span>  <span style=color:#00f>query</span><span style=color:#2b91af>Equipment</span>(filter: { <span style=color:#2b91af>id</span>: { <span style=color:#2b91af>eq</span>: <span style=color:#a31515>&#34;Kitchen_mixer_b_0 1&#34;</span> } }) {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>id</span>
</span></span><span style=display:flex><span>    _createdBy
</span></span><span style=display:flex><span>    versions {
</span></span><span style=display:flex><span>      iid
</span></span><span style=display:flex><span>      description
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    activeVersion {
</span></span><span style=display:flex><span>      iid
</span></span><span style=display:flex><span>      description
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><div class=tab-pane title=RESPONSE><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  &#34;data&#34;: {
</span></span><span style=display:flex><span>    &#34;queryEquipment&#34;: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;id&#34;: <span style=color:#a31515>&#34;Kitchen_mixer_b_01&#34;</span>,
</span></span><span style=display:flex><span>        &#34;_createdBy&#34;: <span style=color:#a31515>&#34;john_snow&#34;</span>,
</span></span><span style=display:flex><span>        &#34;versions&#34;: [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            &#34;iid&#34;: <span style=color:#a31515>&#34;0xcc701&#34;</span>,
</span></span><span style=display:flex><span>            &#34;description&#34;: <span style=color:#a31515>&#34;First generation of the mixer 9000&#34;</span>
</span></span><span style=display:flex><span>          },
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            &#34;iid&#34;: <span style=color:#a31515>&#34;0xcc71a&#34;</span>,
</span></span><span style=display:flex><span>            &#34;description&#34;: <span style=color:#a31515>&#34;Second generation (in testing)&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        &#34;activeVersion&#34;: {
</span></span><span style=display:flex><span>          &#34;iid&#34;: <span style=color:#a31515>&#34;0xcc701&#34;</span>,
</span></span><span style=display:flex><span>          &#34;description&#34;: <span style=color:#a31515>&#34;First generation of the mixer 9000&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div><p>You can also add multiple operations to one call.
For example, this query requests all data sources and all persons:</p><div class=tabs><ul class="nav nav-tabs"></ul><div class=tab-content><div class=tab-pane title=REQUEST><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>peopleAndDataSources</span> {
</span></span><span style=display:flex><span>  <span style=color:#00f>query</span><span style=color:#2b91af>Person</span> {
</span></span><span style=display:flex><span>    id
</span></span><span style=display:flex><span>    label
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#00f>query</span><span style=color:#2b91af>DataSource</span> {
</span></span><span style=display:flex><span>    id
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><div class=tab-pane title=RESPONSE><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  &#34;data&#34;: {
</span></span><span style=display:flex><span>    &#34;queryPerson&#34;: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;id&#34;: <span style=color:#a31515>&#34;999-63-8161&#34;</span>,
</span></span><span style=display:flex><span>        &#34;label&#34;: <span style=color:#a31515>&#34;999-63-8161&#34;</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;id&#34;: <span style=color:#a31515>&#34;235&#34;</span>,
</span></span><span style=display:flex><span>        &#34;label&#34;: <span style=color:#a31515>&#34;John Ramirez&#34;</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;id&#34;: <span style=color:#a31515>&#34;234&#34;</span>,
</span></span><span style=display:flex><span>        &#34;label&#34;: <span style=color:#a31515>&#34;Jan Smith&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    &#34;queryDataSource&#34;: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;id&#34;: <span style=color:#a31515>&#34;x44_mqtt&#34;</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;id&#34;: <span style=color:#a31515>&#34;x45_opcUA&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div><h3 id=variables>Make input dynamic with variables</h3><p>The preceding examples place the query input as <em>inline</em> arguments.
Often, calls to production systems separate these arguments out as JSON <em>variables</em>.</p><p>Variables add dynamism to your requests, which serves to make them more reusable.
For example:</p><ul><li>If you build a low-code reporting application, you could use variables to change the arguments based on user input.</li><li>In a BPMN event orchestration, you could use variables to make a GraphQL call based on a previous JSONata filter. Refer to the example, <a href=https://libremfg.github.io/how-to/bpmn/create-workflow/#write-erp-material-definition-to-database>Write ERP material definition to DB</a>.</li></ul><p>For example, this query places the ID of the resource that it requests as an inline variable:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>myCustomName</span> {
</span></span><span style=display:flex><span>  getEquipment(id: <span style=color:#a31515>&#34;Kitchen_mixer_b_01&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>_createdBy</span>
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>Instead, you can pass this argument as a variable.
This requires the following changes:</p><ol><li><p>In the argument for your query, name the variable and state its type.
This instructs the query to receive data from outside of its context:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:green>## Name variable and type</span>
</span></span><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>myCustomName</span> ($getEquipmentId: <span style=color:#2b91af>String</span>) {
</span></span><span style=display:flex><span>  <span style=color:green>## operations go here.</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p>In the operation, pass the variable as a value in the argument.
In this example, add the variable as a value to the <code>id</code> key like this:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>GetEquipment</span>($getEquipmentId: <span style=color:#2b91af>String</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:green>## pass variable to one or more operations</span>
</span></span><span style=display:flex><span>  getEquipment(id: $getEquipmentId) {
</span></span><span style=display:flex><span>    <span style=color:green>## fields go here</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p>In a separate <code>variables</code> section of the query, define the JSON object that is your variable:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span> &#34;getEquipmentId&#34;: <span style=color:#a31515>&#34;Kitchen_mixer_b_01&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li></ol><div class=tabs><ul class="nav nav-tabs"></ul><div class=tab-content><div class=tab-pane title=QUERY><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>GetEquipment</span>($getEquipmentId: <span style=color:#2b91af>String</span>) {
</span></span><span style=display:flex><span>  getEquipment(id: $getEquipmentId) {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>_createdBy</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Variables</strong>:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span> &#34;getEquipmentId&#34;: <span style=color:#a31515>&#34;Kitchen_mixer_b_01&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div><p>The preceding example is minimal, but the use of variables to <em>parameterize</em> arguments also applies to complex object creation and filtering.
For example, this <em>mutation</em> uses variables to create an array of Persons:</p><div class=tabs><ul class="nav nav-tabs"></ul><div class=tab-content><div class=tab-pane title=MUTATION><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>mutation</span> <span style=color:#2b91af>AddPerson</span>($input: [<span style=color:#2b91af>AddPersonInput</span>!]!) {
</span></span><span style=display:flex><span>  addPerson(<span style=color:#00f>input</span>: $input) {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>person</span> {
</span></span><span style=display:flex><span>      <span style=color:#2b91af>id</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Variables</strong>:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  &#34;input&#34;: [
</span></span><span style=display:flex><span> {&#34;id&#34;: <span style=color:#a31515>&#34;234&#34;</span>, &#34;label&#34;:<span style=color:#a31515>&#34;Jan Smith&#34;</span>},
</span></span><span style=display:flex><span> {&#34;id&#34;: <span style=color:#a31515>&#34;235&#34;</span>, &#34;label&#34;: <span style=color:#a31515>&#34;John Ramirez&#34;</span>}
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div><p>To learn more, read the offical GraphQL documentation on <a href=https://graphql.org/learn/queries/#variables>Variables</a>.</p><h2 id=shortcuts-for-more-expressive-requests>Shortcuts for more expressive requests</h2><p>The following sections provide some common ways to reduce boilerplate and shorten the necessary coding for a call.</p><h3 id=template-requested-fields-with-fragments>Template requested fields with fragments</h3><p>Along with <a href=#variables>variables</a>, you can use <em>fragments</em> to reduce repetitive writing.</p><p>Fragments are common fields that you use when querying an object.
For example, imagine you wanted to make queries to different equipment objects for their <code>id</code>, <code>label</code>, <code>_createdBy</code>, and <code>versions[]</code> properties.
Instead of writing these fields in each operation, you could define them in a fragment, and then refer to that fragment in each specific operation or query.</p><p>To use a fragment:</p><ol><li>Define them with the <code>fragment</code> keyword, declaring its name and object.<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span>         <span style=color:green>## name         ## object</span>
</span></span><span style=display:flex><span><span style=color:#00f>fragment</span> <span style=color:#2b91af>CommonFields</span> <span style=color:#00f>on</span> Equipment
</span></span></code></pre></div></li><li>Include the fragment in the fields for your operation by prefacing its name with three dots:<pre tabindex=0><code>...CommonFields
</code></pre></li></ol><p>For example:</p><div class=tabs><ul class="nav nav-tabs"></ul><div class=tab-content><div class=tab-pane title=QUERY><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:green>## Define common fields</span>
</span></span><span style=display:flex><span><span style=color:#00f>fragment</span> <span style=color:#2b91af>CommonFields</span> <span style=color:#00f>on</span> Equipment{
</span></span><span style=display:flex><span>  id
</span></span><span style=display:flex><span>  label
</span></span><span style=display:flex><span>  _createdBy
</span></span><span style=display:flex><span>  versions {
</span></span><span style=display:flex><span>    id
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>## Use them in your query.</span>
</span></span><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>kitchenEquipment</span> {
</span></span><span style=display:flex><span>  getEquipment(id: <span style=color:#a31515>&#34;Kitchen_mixer_b_01&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#00f>...</span><span style=color:#2b91af>CommonFields</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Variables:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  &#34;data&#34;: {
</span></span><span style=display:flex><span>    &#34;getEquipment&#34;: {
</span></span><span style=display:flex><span>      &#34;id&#34;: <span style=color:#a31515>&#34;Kitchen_mixer_b_02&#34;</span>,
</span></span><span style=display:flex><span>      &#34;label&#34;: <span style=color:#a31515>&#34;Kitchen mixer B02&#34;</span>,
</span></span><span style=display:flex><span>      &#34;_createdBy&#34;: <span style=color:#a31515>&#34;admin@rhize.com&#34;</span>,
</span></span><span style=display:flex><span>      &#34;versions&#34;: []
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div><h3 id=filter>Filter arrays</h3><p>Whether you make a query or mutation, you often may specify to receive an array of items in response.
To minimize payload, isolate necessary resources, and maximize the signal-to-noise ratio, it&rsquo;s often useful to filter this array to a subset of items.</p><div class="notices note"><span class=type>Note</span> Rhize&rsquo;s filter implementation is based on Dgraph&rsquo;s <a href=https://dgraph.io/docs/graphql/schema/directives/search/>search directive</a>.
Refer to their document for the full list of fields and filters.</div><p>To use filters:</p><ol><li>Specify a <code>filter</code> field in your argument.</li><li>Use the Apollo explorer to select the object. As a quick reference, you can filter the following data types:<table><thead><tr><th>Data type</th><th>Filters</th></tr></thead><tbody><tr><td>Boolean</td><td><code>true</code> and <code>false</code></td></tr><tr><td>Date and time</td><td><code>lt</code> (less than), <code>gt</code> (greater than), <code>between</code>, <code>eq</code> (equals)</td></tr><tr><td>String</td><td><code>lt</code> (less than), <code>gt</code> (greater than), <code>between</code>, <code>eq</code> (equals),<br><code>regexp</code> (regular expression based on <a href=https://github.com/google/re2/wiki/Syntax/>re2</a> syntax).</td></tr><tr><td>String</td><td><code>exact</code></td></tr></tbody></table></li></ol><h3 id=cascade>Cascade</h3><p><code>@cascade</code> is a <a href=https://www.apollographql.com/docs/apollo-server/schema/directives/>directive</a> that filters certain nodes within a query.
It is similar to a <code>WHERE</code> clause in SQL.</p><div class="notices caution"><span class=type>Caution</span> <code>@cascade</code> is not as performant as flatter queries.
Consider using it only after you&rsquo;ve exhausted other query structures to return the data you want.</div><p>For example, this query <a href=https://libremfg.github.io/how-to/gql/call-the-graphql-api/#filter>filters</a> for job responses with an ID of <code>12341</code>, and then filters that set for only the items that have a <code>data.properyLabel</code> field with a value of <code>INSTANCE ID</code>.</p><div class=tabs><ul class="nav nav-tabs"></ul><div class=tab-content><div class=tab-pane title=QUERY><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>QueryJobResponse</span>($filter: <span style=color:#2b91af>JobResponseFilter</span>, $propertyLabel: <span style=color:#2b91af>String</span>) {
</span></span><span style=display:flex><span>  <span style=color:#00f>query</span><span style=color:#2b91af>JobResponse</span>(filter: $filter)  @cascade(<span style=color:#2b91af>fields</span>:[<span style=color:#a31515>&#34;data&#34;</span>]){
</span></span><span style=display:flex><span>    <span style=color:#2b91af>id</span>
</span></span><span style=display:flex><span>    iid
</span></span><span style=display:flex><span>    data(filter: { <span style=color:#2b91af>label</span>: { <span style=color:#2b91af>anyoftext</span>: $propertyLabel } }) {
</span></span><span style=display:flex><span>      <span style=color:#2b91af>id</span>
</span></span><span style=display:flex><span>      iid
</span></span><span style=display:flex><span>      label
</span></span><span style=display:flex><span>      value
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Variables</strong>:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    &#34;filter&#34;: {
</span></span><span style=display:flex><span>        &#34;id&#34;: {
</span></span><span style=display:flex><span>            &#34;alloftext&#34;: <span style=color:#a31515>&#34;12341&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    &#34;propertyLabel&#34;: <span style=color:#a31515>&#34;INSTANCE ID&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div></article><div class=right-toc><nav id=TableOfContents><ul><li><a href=#operation-types>Operation types</a></li><li><a href=#call-syntax>Call syntax</a><ul><li><a href=#authentication>Authentication</a></li><li><a href=#request-body>Request body</a></li><li><a href=#request-exactly-the-data-you-want>Request exactly the data you want</a></li><li><a href=#variables>Make input dynamic with variables</a></li></ul></li><li><a href=#shortcuts-for-more-expressive-requests>Shortcuts for more expressive requests</a><ul><li><a href=#template-requested-fields-with-fragments>Template requested fields with fragments</a></li><li><a href=#filter>Filter arrays</a></li><li><a href=#cascade>Cascade</a></li></ul></li></ul></nav></div></div></main><script type=text/javascript src=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js></script><script src=https://libremfg.github.io/js/clipboard.min.js></script><script src=https://libremfg.github.io/js/dgraph.js?a9873668f1334ff6c49d4edea0a4bc38></script><script>hljs.initHighlightingOnLoad()</script></body></html>