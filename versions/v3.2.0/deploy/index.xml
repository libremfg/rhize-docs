<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Rhize documentation – Deploy</title><link>https://docs.rhize.com/versions/v3.2.0/deploy/</link><description>Recent content in Deploy on Rhize documentation</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 04 Nov 2024 11:01:46 -0300</lastBuildDate><atom:link href="https://docs.rhize.com/versions/v3.2.0/deploy/index.xml" rel="self" type="application/rss+xml"/><item><title>Install</title><link>https://docs.rhize.com/versions/v3.2.0/deploy/install/</link><pubDate>Fri, 22 Sep 2023 13:54:26 -0300</pubDate><guid>https://docs.rhize.com/versions/v3.2.0/deploy/install/</guid><description>
&lt;p>This guide shows you how to install Rhize services on your Kubernetes cluster.&lt;/p>
&lt;div class="hx:overflow-x-auto hx:mt-6 hx:flex hx:rounded-lg hx:border hx:py-2 hx:ltr:pr-4 hx:rtl:pl-4 hx:contrast-more:border-current hx:contrast-more:dark:border-current hx:border-blue-200 hx:bg-blue-100 hx:text-blue-900 hx:dark:border-blue-200/30 hx:dark:bg-blue-900/30 hx:dark:text-blue-200">
&lt;div class="hx:ltr:pl-3 hx:ltr:pr-2 hx:rtl:pr-3 hx:rtl:pl-2">&lt;div class="hx:select-none hx:text-xl" style="font-family: 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';">ℹ️&lt;/div>&lt;/div>
&lt;div class="hx:w-full hx:min-w-0 hx:leading-7">
&lt;div class="hx:mt-6 hx:leading-7 hx:first:mt-0">This procedure aims to be as generic and vendor-neutral as possible.
Some configuration depends on where and how you run your IT infrastructure—what cloud provider you use, preferred auxiliary tools, and so on&amp;mdash;so your team must adapt the process for its particular use cases.&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="hextra-cards hx:mt-4 hx:gap-4 hx:grid not-prose"
style="--hextra-cards-grid-cols: 4;">
&lt;/div></description></item><item><title>Back up</title><link>https://docs.rhize.com/versions/v3.2.0/deploy/backup/</link><pubDate>Tue, 12 Sep 2023 19:35:35 +1100</pubDate><guid>https://docs.rhize.com/versions/v3.2.0/deploy/backup/</guid><description>
&lt;p>Backup is critical to ensure reliability and recovery.&lt;/p>
&lt;p>These guides show you how to back up different services and data on Rhize.
They also serve as blueprints for automation.&lt;/p>
&lt;p>Your organization must determine how frequently you backup services, and how long you store them for.
The correct practice here is highly contextual,
depending on the size of the data, the importance of the data, and the general regulatory and governance demands of your industry.&lt;/p>
&lt;div class="hextra-cards hx:mt-4 hx:gap-4 hx:grid not-prose"
style="--hextra-cards-grid-cols: 4;">
&lt;/div></description></item><item><title>Restore</title><link>https://docs.rhize.com/versions/v3.2.0/deploy/restore/</link><pubDate>Tue, 12 Sep 2023 19:35:35 +1100</pubDate><guid>https://docs.rhize.com/versions/v3.2.0/deploy/restore/</guid><description>
&lt;p>These guides show you how to restore data from &lt;a href="https://docs.rhize.com/versions/v3.2.0/deploy/backup/" >backup&lt;/a>.
They also serve as blueprints for automation.&lt;/p>
&lt;p>Even if you don&amp;rsquo;t need to restore data, it&amp;rsquo;s a good practice to test restoration periodically.&lt;/p>
&lt;div class="hextra-cards hx:mt-4 hx:gap-4 hx:grid not-prose"
style="--hextra-cards-grid-cols: 4;">
&lt;/div></description></item><item><title>Maintain</title><link>https://docs.rhize.com/versions/v3.2.0/deploy/maintain/</link><pubDate>Tue, 26 Mar 2024 19:35:35 +1100</pubDate><guid>https://docs.rhize.com/versions/v3.2.0/deploy/maintain/</guid><description>
&lt;p>Maintenance is critical to ensure reliability over time.&lt;/p>
&lt;p>These guides show you how to maintain different services and data on Rhize.
They also serve as blueprints for automation.&lt;/p>
&lt;p>Your organization must determine how you maintain your services, and how often you archive or remove data.
The correct practice here is highly contextual, depending on the size of the data, the importance of the data, and the general regulatory and governance demands of your industry.&lt;/p>
&lt;div class="hextra-cards hx:mt-4 hx:gap-4 hx:grid not-prose"
style="--hextra-cards-grid-cols: 4;">
&lt;/div></description></item><item><title>Upgrade</title><link>https://docs.rhize.com/versions/v3.2.0/deploy/upgrade/</link><pubDate>Wed, 18 Oct 2023 15:02:24 -0300</pubDate><guid>https://docs.rhize.com/versions/v3.2.0/deploy/upgrade/</guid><description>
&lt;p>This guide shows you how to upgrade Rhize.&lt;/p>
&lt;div class="notices warning">
&lt;span class="type">Back up first&lt;/span>
Before upgrading, consider backing up your Rhize services.
To review the procedure, read our &lt;a href="https://docs.rhize.com/deploy/backup">Back up guides&lt;/a>.
&lt;/div>
&lt;h2>Prerequisites&lt;span class="hx:absolute hx:-mt-20" id="prerequisites">&lt;/span>
&lt;a href="#prerequisites" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Before you start, ensure you have the following:&lt;/p>
&lt;ul>
&lt;li>Access to the &lt;a href="https://docs.rhize.com/versions/v3.2.0/" >Rhize Kubernetes Environment&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://helm.sh/docs/helm/helm_install/" target="_blank" rel="noopener">helm&lt;/a>&lt;/li>
&lt;li>Optional: &lt;a href="https://github.com/ahmetb/kubectx" target="_blank" rel="noopener">kubectx&lt;/a> utilities
&lt;ul>
&lt;li>&lt;code>kubectx&lt;/code> to manage multiple clusters&lt;/li>
&lt;li>&lt;code>kubens&lt;/code> to switch between and configure namespaces easily&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Optional: the &lt;a href="https://k8slens.dev" target="_blank" rel="noopener">k8 Lens IDE&lt;/a>, if you prefer to use Kubernetes graphically&lt;/li>
&lt;/ul>
&lt;p>Be sure that you notify relevant parties of the coming upgrade.&lt;/p>
&lt;h2>Procedure&lt;span class="hx:absolute hx:-mt-20" id="procedure">&lt;/span>
&lt;a href="#procedure" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>First, record the old and new versions, their context, and namespaces.&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Check the logs for the libre pods, either in Lens or with &lt;a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#logs" target="_blank" rel="noopener">&lt;code>kubectl logs&lt;/code>&lt;/a>.
Ensure there are no errors.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Use Git to pull your Rhize customer build directory.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Change to the &lt;code>kubernetes/charts/libre&lt;/code> directory.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Check your Kubernetes context and namespace.&lt;/p>
&lt;div class="hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## context&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl config current-context
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## namespace&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl get namespace&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0">
&lt;button
class="hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;div class="hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>To change the namespace for all subsequent &lt;a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/" target="_blank" rel="noopener">&lt;code>kubectl&lt;/code> commands&lt;/a> to &lt;code>libre&lt;/code>, run this command:&lt;/p>
&lt;div class="hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl config set-context --current --namespace&lt;span class="o">=&lt;/span>libre&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0">
&lt;button
class="hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;div class="hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Update Helm repositories with the following command:&lt;/p>
&lt;div class="hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">helm repo update&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0">
&lt;button
class="hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;div class="hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Use the &lt;code>helm list&lt;/code> command to check for libre services.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Upgrade with the following command:&lt;/p>
&lt;div class="hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">helm upgrade libre -f &amp;lt;NAMESPACE&amp;gt;.yaml -n namespace&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0">
&lt;button
class="hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;div class="hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Get a token using your credentials.
With &lt;code>curl&lt;/code>, it looks like this:&lt;/p>
&lt;div class="hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">curl --location --request POST &lt;span class="s1">&amp;#39;https://&amp;lt;AUTH_SUBDOMAIN&amp;gt;-&amp;lt;YOUR_DOMAIN&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">auth.libre/realms/libre/protocol/openid-connect/token&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--header &lt;span class="s1">&amp;#39;Content-Type: application/x-www-form-urlencoded&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--data-urlencode &lt;span class="s1">&amp;#39;grant_type=password&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--data-urlencode &lt;span class="s1">&amp;#39;username=system@libre.com&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--data-urlencode &lt;span class="s1">&amp;#39;password=&amp;lt;PASSWORD&amp;gt;&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--data-urlencode &lt;span class="s1">&amp;#39;client_id=libreBaas&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--data-urlencode &lt;span class="s1">&amp;#39;client_secret=&amp;lt;CLIENT_SECRET&amp;gt;&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0">
&lt;button
class="hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;div class="hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Redeploy the schema. To do so, you need to interact with the &lt;code>alpha&lt;/code> service on port &lt;code>8080&lt;/code>. You can do this in multiple ways. Either enter the alpha shell with a command such as &lt;code>kubectl exec --stdin baas-alpha-0 -- sh&lt;/code>, or forward the port to your local instance using a command such as &lt;code>kubectl port-forward baas-alpha-0 8080:8080&lt;/code>.&lt;/p>
&lt;p>For example, using port forwarding, a &lt;code>curl&lt;/code> command to deploy the schema looks like this:&lt;/p>
&lt;div class="hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">curl --location -X POST &lt;span class="s1">&amp;#39;http://localhost:&amp;lt;FORWARDED_PORT&amp;gt;/admin/schema&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>-H &lt;span class="s2">&amp;#34;Authorization: Bearer &lt;/span>$&lt;span class="s2">&amp;lt;TOKEN&amp;gt;&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>-H &lt;span class="s2">&amp;#34;content-Type: application/octet-stream&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--data-binary &amp;lt;PATH/TO/SCHEMA&amp;gt;.sdl&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0">
&lt;button
class="hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;div class="hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>The schema file is likely called something like &lt;code>schema.sdl&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Restart the Apollo Router Statefulset so that the Supergraph is composed with all the latest changes. For example:&lt;/p>
&lt;/li>
&lt;/ol>
&lt;div class="hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">kubectl rollout restart statefulset router&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0">
&lt;button
class="hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;div class="hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>Verify success&lt;span class="hx:absolute hx:-mt-20" id="verify-success">&lt;/span>
&lt;a href="#verify-success" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Verify success in Kubernetes by checking that the version upgraded properly and that the logs are correct.&lt;/p>
&lt;p>Inform your team that the upgrade was successful.&lt;/p></description></item></channel></rss>