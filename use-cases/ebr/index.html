<!doctype html><html lang=en class="js csstransforms3d"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-0PJKXDWQ4P"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0PJKXDWQ4P")}</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=referrer content="no-referrer-when-downgrade"><meta property="og:image" content="https://docs.rhize.com//images/og/graphic-rhize-ebr.png"><meta property="og:image:secure_url" content="https://docs.rhize.com/images/og/graphic-rhize-ebr.png"><meta property="og:description" content="An example of how to use Rhize to create Electronic Batch Records for pharmaceutical manufacturing"><meta property="og:type" content="website"><meta property="og:title" content="Electronic batch records"><meta property="og:site_name" content="Rhize documentation"><meta property="og:url" content="https://docs.rhize.com/use-cases/ebr/"><meta property="og:locale" content="en"><meta name=generator content="Hugo 0.132.1"><meta name=description content="An example of how to use Rhize to create Electronic Batch Records for pharmaceutical manufacturing"><link rel=canonical href=https://docs.rhize.com/use-cases/ebr/><link rel=apple-touch-icon sizes=57x57 href=https://docs.rhize.com/images/favicons/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=https://docs.rhize.com/images/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=https://docs.rhize.com/images/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=https://docs.rhize.com/images/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=https://docs.rhize.com/images/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=https://docs.rhize.com/images/favicons/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=https://docs.rhize.com/images/favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=https://docs.rhize.com/images/favicons/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=https://docs.rhize.com/images/favicons/apple-touch-icon-180x180.png><link rel=icon type=image/png href=https://docs.rhize.com/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://docs.rhize.com/images/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=https://docs.rhize.com/images/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://docs.rhize.com/images/favicons/favicon-16x16.png sizes=16x16><link rel=manifest href=https://docs.rhize.com/images/favicons/manifest.webmanifest><link rel=mask-icon href=https://docs.rhize.com/images/favicons/safari-pinned-tab.svg color=#fe2c06><link rel="shortcut icon" href=https://docs.rhize.com/images/favicons/favicon.ico><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js></script><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/go.min.js></script><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/java.min.js integrity="sha256-RyOs5MjQ+Ef9DQrPHp4QGr2tcNjxLh6mCkkW+sS4doU=" crossorigin=anonymous></script><script src=//code.jquery.com/jquery-3.2.1.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><title>Electronic batch records
|
Use cases
</title><link href=https://docs.rhize.com/css/theme.css?55e52aec195a82e2ea2d860ffc75cf75 rel=stylesheet><link href=https://docs.rhize.com/css/runnable.css?46648956d99faa2e057d109b9f2a52e6 rel=stylesheet><link href=https://docs.rhize.com/css/tabs.css?035edc32762cb7973b740e3067101ced rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css rel=stylesheet integrity=sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ crossorigin=anonymous><script src=//cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js integrity=sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb crossorigin=anonymous></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js integrity=sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn crossorigin=anonymous></script><link href="//fonts.googleapis.com/css?family=Lato:400,700" rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link href=https://cdn.lineicons.com/2.0/LineIcons.css rel=stylesheet crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3></head><body><nav id=header><div class=header-left><div><a href=https://docs.rhize.com/ class=brand><img src=https://docs.rhize.com//images/rhize-logo.png alt=RHIZE class=logo></a><div class=logo-tagline><span>Documentation</span></div></div></div><div class=header-right><div id=docsearch><div class="menu-search align-middle"><div id=docsearch></div></div></div><div><ul class=menu><li><a href=https://rhize.com target=_blank>Home</a></li><li><a href=https://forum.rhize.com target=_blank>Community</a></li><li><a href=https://www.youtube.com/@rhizemanufacturingdatahub target=_blank>Youtube</a></li></ul></div></div><a href=# id=sidebar-toggle><i class="fa fa-bars"></i></a></nav><aside id=sidebar><ul class=topics><li class="topic main-topic children"><a id=get-started href=#>Get started</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/get-started/introduction/>What is Rhize?</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/get-started/how-rhize-works/>How Rhize works</a></li></ul></li><li class="topic main-topic children"><a id=deploy href=#>Deploy</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Install</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/install/overview/>Overview</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/install/setup-kubernetes/>Set up Kubernetes</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/install/keycloak/>Configure Keycloak</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/install/services/>Install Rhize services</a></li></ul></li><li class="topic sub-topic"><a href=#>Back up</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/backup/graphdb/>Back up the Graph DB</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/backup/audit/>Back up Audit PostgreSQL</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/backup/grafana/>Back up Grafana</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/backup/keycloak/>Back up Keycloak</a></li></ul></li><li class="topic sub-topic"><a href=#>Restore</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/restore/graphdb/>Restore the GraphDB</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/restore/audit/>Restore Audit backup</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/restore/grafana/>Restore Grafana</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/restore/keycloak/>Restore Keycloak</a></li></ul></li><li class="topic sub-topic"><a href=#>Maintain</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/maintain/audit/>Archive the PostgreSQL Audit trail</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/maintain/bpmn-nodes/>BPMN execution recovery</a></li></ul></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/upgrade/>Upgrade</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/deploy/about-openidconnect/>About OpenID connect</a></li></ul></li><li class="topic main-topic children"><a id=user-guides href=#>User guides</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Use GraphQL</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/call-the-graphql-api/>Overview: the Rhize API</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/query/>Query</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/filter/>Filter</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/mutate/>Mutate</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/gql/subscribe/>Subscribe</a></li></ul></li><li class="topic sub-topic"><a href=#>Write BPMN workflows</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/create-workflow/>Overview: orchestrate processes</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/trigger-workflows/>Trigger workflows</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/use-jsonata/>Use JSONata</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/debug-workflows/>Handle errors and debug</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/tune-performance/>Tune performance</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/variables/>Special variables</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/naming-conventions/>Naming conventions</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/learning-resources/>BPMN learning resources</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/bpmn/bpmn-elements/>BMPN elements</a></li></ul></li><li class="topic sub-topic"><a href=#>Define production models</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/model/create-objects-ui/>Create objects from the UI</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/model/master-definitions/>Master definitions and fields</a></li></ul></li><li class="topic sub-topic"><a href=#>Connect event data</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/publish-subscribe/connect-datasource/>Connect data source</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/publish-subscribe/create-equipment-class-rule/>Tutorial: Trigger a workflow from a rule</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/publish-subscribe/track-changes/>Track changes (CDC)</a></li></ul></li><li class="topic sub-topic"><a href=#>Use work calendars</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/work-calendars/about-calendars-and-overrides/>About calendars and overrides</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/work-calendars/create-work-calendar/>Create work calendars</a></li></ul></li><li class="topic sub-topic"><a href=https://docs.rhize.com/how-to/audit/>Audit</a></li></ul></li><li class="topic main-topic children active"><a id=use-cases href=#>Use cases</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/use-cases/overview/>Overview</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/use-cases/genealogy/>Genealogy</a></li><li class="topic sub-topic active"><a href=https://docs.rhize.com/use-cases/ebr/>Electronic batch records</a></li></ul></li><li class="topic main-topic children"><a id=reference href=#>Reference</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Service configuration</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/agent-configuration/>Agent configuration</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/audit-configuration/>Audit configuration</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/bpmn-configuration/>BPMN configuration</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/calendar-configuration/>Calendar configuration</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/service-config/core-configuration/>Core configuration</a></li></ul></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/default-ports/>Default URLs and local ports</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/gql-types/>GQL types and filters</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/reference/glossary/>Glossary</a></li></ul></li><li class="topic main-topic children"><a id=explanations href=#>Explanations</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/explanations/manufacturing-data-hub/>Manufacturing Data Hub</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/explanations/isa-95-diagrams/>ISA-95 diagrams</a></li></ul></li><li class="topic main-topic children"><a id=releases href=#>Releases</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/3-0-1/>3.0.1</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/3-0/>3.0.0</a></li><li class="topic sub-topic"><a href=#>Changelog</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0/>3.0.0 (general release)</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc09/>3.0.0rc09</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc08/>3.0.0rc08</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc07/>3.0.0rc07</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc06/>3.0.0rc06</a></li><li class="topic sub-topic"><a href=https://docs.rhize.com/releases/changelog/3-0-0rc05/>3.0.0rc05</a></li></ul></li></ul></li><li class="topic main-topic"><a href=https://docs.rhize.com/></a></li></ul></aside><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script><script type=text/javascript>docsearch({appId:"70JLDGIDQA",apiKey:"2b4c57aa9d3d0386bf1a6df5b54eb3cf",indexName:"rhize",insights:!0,container:"#docsearch",debug:!1})</script></body></html><main class=content-wrapper><div class=content><div class=top-toc><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#steps-to-automate-ebr-creation>Steps to automate eBR creation</a><ul><li><a href=#identify-the-sources-of-data>Identify the sources of data</a></li><li><a href=#model-the-fields-as-isa-95-schema>Model the fields as ISA-95 schema</a></li><li><a href=#write-a-bpmn-workflow-to-ingest-the-data-in-real-time>Write a BPMN workflow to ingest the data in real-time</a></li><li><a href=#query-the-db-with-the-ebr-fields>Query the DB with the eBR fields</a></li></ul></li><li><a href=#next-steps>Next steps</a></li></ul></nav></div><article><a class=edit-btn target=_blank href=https://github.com/libremfg/libremfg.github.io/edit/main/content/use-cases/ebr.md><i class="fa fa-github-alt"></i> Edit Page</a><h1 class=post-title>Electronic batch records</h1><p>In pharmaceutical manufacturing, an <em>Electronic Batch Record (eBR)</em> is a detailed report about a specific batch.
It includes information about items such as the process segments, material, personnel, and equipment.</p><p>As Rhize can ingest data from all levels of the manufacturing process, and do so in real-time, it is an ideal single source of truth to create eBRs.
The process can be automated and highly efficient.
Our experience in production systems shows that Rhize can typically generate an eBR in less than 500 milliseconds.</p><p>The procedure has the following steps:</p><ol><li>Identify the sources of data.</li><li>Map the fields for these data sources to Rhize&rsquo;s ISA-95 schema.</li><li>Write <abbr title="Business Process Model and Notation. A standardized graphical notation used to represent business processes in an intuitive, visual way. Rhize's BPMN UI and engine provides a low-code interface for complex event handling">BPMN</abbr> processes that listen to data sources, transform the incoming data to the schema, and then send a <abbr title="A GraphQL operation that modifies some data in the database, usually creating, updating, or deleting a resource">mutation</abbr> to update the Rhize database.</li><li>After the batch finishes, query the database with the fields for your <abbr title="Electronic batch report. A detailed report for a batch in a pharmaceutical process, logging items such as the process segments, personnel, equipment, material substance and weight, and so on">eBR</abbr>.</li></ol><p>The following sections describe this process in a bit more detail.</p><h2 id=prerequisites>Prerequisites</h2><p>This procedure involves multiple data sources and different operations to transform the incoming data and store it in the graph database.
Before you start, ensure that you have the following:</p><ul><li>Awareness of the different sources of eBR data</li><li>If real-time data comes from equipment, <a href=https://docs.rhize.com/how-to/publish-subscribe/connect-datasource/>Connected data sources</a></li><li>Sufficient knowledge of the ISA-95 standard to model the input data as ISA-95 schema</li><li>In the BPMN process, the ability to filter JSON and <a href=https://docs.rhize.com/how-to/gql/>call the GraphQL API</a></li></ul><p>In larger operations, different teams may help with different parts of the eBR-creation process.
For example, your integrators may help appropriately model the data, and the frontend team may render the outputted JSON into a final document.</p><h2 id=steps-to-automate-ebr-creation>Steps to automate eBR creation</h2><p>The following steps describe the broad procedure to automatically update the database for incoming batch data, then automatically create an eBR after the batch run.</p><h3 id=identify-the-sources-of-data>Identify the sources of data</h3><p>The first step is to identify the sources of data for your eBR.</p><figure><img src=https://docs.rhize.com/images/ebr/diagram-rhize-example-ebr-sources.png alt="Diagram showing some examples of eBR data sources" width=75%></figure><p>Common data sources for an eBR might include:</p><ul><li><strong><abbr title='Enterprise resource planning. Software to manage business processes. In Rhize, ERP activities usually are named "operations", where lower-level activities are prefixed with "Work".'>ERP</abbr> documents:</strong> high-level operations documents</li><li><strong><abbr title="Manufacturing execution system. A system in a manufacturing process that tracks and documents the transformation of raw materials to finished goods">MES</abbr> data:</strong> granular process data, tracking objects such as the weight of individual material and the responses for different jobs.</li><li><strong><abbr title="Laboratory information management system. Software that tracks laboratory data, including samples, experiments, and workflows">LIMS</abbr> documents:</strong> information about the laboratory environment</li><li><strong>Real-time event data:</strong> for example, data sent from OPC UA or MQTT servers</li></ul><h3 id=model-the-fields-as-isa-95-schema>Model the fields as ISA-95 schema</h3><p>After you&rsquo;ve identified the source data, the next step is to map this data into ISA-95 models.</p><figure><img src=https://docs.rhize.com/images/ebr/diagram-rhize-map-ebr-isa95.png alt="diagram showing some examples of ISA-95 modeling" width=80%></figure><p>Some common objects to map include raw and final material, equipment, personnel, operations schedule, segments, job responses, and the ERP batch number.</p><p>Once ingested, all data is linked through common associations in the graph database, and is thus accessible through a single query.</p><h3 id=write-a-bpmn-workflow-to-ingest-the-data-in-real-time>Write a BPMN workflow to ingest the data in real-time</h3><figure class=big-figure><a href=https://docs.rhize.com/images/ebr/diagram-rhize-bpmn-ebr.png target=_blank><img src=https://docs.rhize.com/images/ebr/diagram-rhize-bpmn-ebr.png alt="Example of a BPMN workflow" width=60%></a><figcaption class=caption>A simplified BPMN workflow. For an example of a real workflow with nodes for each logic step, refer to the next image.</figcaption></figure><p>With the sources of data and their corresponding models, the next step
is to write a <a href=https://docs.rhize.com/how-to/bpmn/><abbr title="Business Process Model and Notation. A standardized graphical notation used to represent business processes in an intuitive, visual way. Rhize's BPMN UI and engine provides a low-code interface for complex event handling">BPMN</abbr></a> workflow to automatically transform the data and update the database.</p><div class="notices note"><span class=type>Note</span> You may want to break these steps into multiple parts.
Or, for increased modularity, you can call another BPMN workflow with a <a href=https://docs.rhize.com/how-to/bpmn/bpmn-elements/#call-activities>Call activity</a>.</div><p>The procedure is as follows:</p><ol><li><p>Subscribe to the topic for the appropriate data (for example <code>/lims/lab1</code>). If the data comes from certain equipment, you first need to <a href=https://docs.rhize.com/how-to/publish-subscribe/connect-datasource/>Connect a data source</a>.</p></li><li><p>Transform with JSONata</p><p>Rhize has a built-in JSONata interpreter, which can filter and transform JSON.
Use a <a href=https://docs.rhize.com/how-to/bpmn/bpmn-elements/#jsonata-transform>JSONata service task</a> to map the data sources into the corresponding ISA-95 fields that you defined on the previous step.</p><p>Use the output as a variable for the next step.</p></li><li><p>POST data with a graph mutation.</p><p>Use the variable returned by the JSONata step to send a mutation to update the Graph database with the new fields.
To learn more, read the <a href=https://docs.rhize.com/how-to/gql/>Guide to GraphQL with Rhize</a>.</p></li></ol><p>In real BPMN workflows, you can dynamically create and assign fields as they enter the system.
For example, this workflow creates a new material definition and material-definition version based on whether this object already exists.</p><figure class=big-figure><a href=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-add-material-definition.png target=_blank><img src=https://docs.rhize.com/images/bpmn/screenshot-rhize-bpmn-add-material-definition.png alt="Screenshot of a BPMN workflow that adds material only if it exists"></a></figure><p>This step can involve multiple BPMN processes subscribing to different topics.
As long as the incoming event data has a common association, for example through the <code>id</code> of the batch data and associated <code>JobResponse</code>, you can return all eBR fields in one GraphQL query—no recursive SQL joins needed.</p><figure><img src=https://docs.rhize.com/images/ebr/diagram-rhize-inputs-for-ebr.png alt="Multiple BPMN processes can be united in one batch" width=75%></figure><h3 id=query-the-db-with-the-ebr-fields>Query the DB with the eBR fields</h3><p>After the batch finishes, use a <a href=https://docs.rhize.com/how-to/gql/query/>GraphQL query</a> to receive all relevant batch data.
You only need one precise request to return exactly the data you specify.</p><figure><img src=https://docs.rhize.com/images/ebr/diagram-rhize-make-ebr-query.png alt="Diagram showing how a query makes an ebr" width=55%></figure><p>Our experience has shown us that the query is about 300 lines. Here&rsquo;s a
small, generic snippet of how it looks:</p><input type=checkbox id=expandable-1723569193970066536 class=expandable-checkbox>
<label for=expandable-1723569193970066536 class=expandable-label><div class=expandable-header><div class=expandable-title>Snippet of a makeEbr query</div><div class=expandable-toggle>+</div></div><div class=expandable-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> <span style=color:#2b91af>makeEbr</span> ($filter: <span style=color:#2b91af>JobOrderFilter</span>) {
</span></span><span style=display:flex><span>  <span style=color:#00f>query</span><span style=color:#2b91af>JobResponse</span>(filter: $filter) {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>EXAMPLE_id</span>: <span style=color:#2b91af>id</span>
</span></span><span style=display:flex><span>    description
</span></span><span style=display:flex><span>    matActualProduced: <span style=color:#2b91af>materialActual</span>(filter:{<span style=color:#2b91af>materialUse</span>: { <span style=color:#2b91af>eq</span>:<span style=color:#2b91af>Produced</span> }}){
</span></span><span style=display:flex><span>      id
</span></span><span style=display:flex><span>      material: <span style=color:#2b91af>materialDefinitionVersion</span>{
</span></span><span style=display:flex><span>        id
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      quantity
</span></span><span style=display:flex><span>      quantityUoM {
</span></span><span style=display:flex><span>        id
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  <span style=color:green>## More EBR fields</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></label><p>Note how the query specifies exactly the fields to return: no further filtering of the response is required.
The only further step to use the returned JSON object as the input for however you create your eBR documents.</p><h2 id=next-steps>Next steps</h2><p>Fast eBR automation is just one of many use cases of Rhize in the pharmaceutical industry.
With the same event data that you automatically ingest and filter in this workflow, you can also:</p><ul><li>Program reactive logic using BPMN for <abbr title="A pattern in event-driven architecture where a central service, such as NATS, listens to events and decides how to handle them.">event orchestration</abbr>. For example, you might send an alert after detecting a threshold condition.</li><li>Analyze multiple batch runs for deviations. For example, you can query every instance of a failure mode across all laboratories.</li><li>Compare batches against some variable. For example, you can compare all runs for two versions of equipment.</li></ul></article><div class=right-toc><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#steps-to-automate-ebr-creation>Steps to automate eBR creation</a><ul><li><a href=#identify-the-sources-of-data>Identify the sources of data</a></li><li><a href=#model-the-fields-as-isa-95-schema>Model the fields as ISA-95 schema</a></li><li><a href=#write-a-bpmn-workflow-to-ingest-the-data-in-real-time>Write a BPMN workflow to ingest the data in real-time</a></li><li><a href=#query-the-db-with-the-ebr-fields>Query the DB with the eBR fields</a></li></ul></li><li><a href=#next-steps>Next steps</a></li></ul></nav></div></div></main><script type=text/javascript src=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js></script><script src=https://docs.rhize.com/js/clipboard.min.js></script><script src=https://docs.rhize.com/js/dgraph.js?a9873668f1334ff6c49d4edea0a4bc38></script><script>hljs.initHighlightingOnLoad()</script></body></html>